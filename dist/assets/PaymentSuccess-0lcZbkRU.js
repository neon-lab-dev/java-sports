import{o as h,j as e,g as x,L as g,c as N,e as P,f as v,u as b,r as I,_ as p,d as w}from"./index-bzqS1RBf.js";import C from"./NotFound-Ytr645Y_.js";import{d as k}from"./orders-l0rvhfFf.js";const m=t=>t.orderItems.reduce((a,s)=>a+s.price*s.quantity,0),O=()=>{const[t]=h();return t.get("reference")?x("orderDetails",null)?e.jsx(F,{}):e.jsx("div",{className:"bg-white py-10 h-80",children:e.jsxs("section",{className:"wrapper flex items-center justify-center flex-col gap-4 h-full",children:[e.jsx("h1",{className:"text-2xl font-600 text-black",children:"You have no orders to track."}),e.jsx(g,{to:"/",className:"text-white font-500 hover:underline bg-primary/2 px-3 py-2 rounded-md",children:"Continue Shopping"})]})}):e.jsx(C,{})},F=()=>{var l,d,u;const[t]=h(),a=N(),{user:s}=P(S=>S.user),f=v(),r=x("orderDetails",null),y={shippingInfo:r.deliveryAddress||{...s.primaryaddress,pinCode:s.primaryaddress.pin_code.toString(),phoneNo:s.phoneNo.toString()},orderItems:r.orderItems,itemsPrice:(l=m(r))==null?void 0:l.toString(),totalPrice:(m(r)-((d=r==null?void 0:r.coupon)!=null&&d.isCouponApplied?r.coupon.discount:0)).toString(),discount:((u=r==null?void 0:r.coupon)!=null&&u.isCouponApplied?r.coupon.discount:0).toString(),razorpay_payment_id:t.get("reference")},{isLoading:j,data:c,isSuccess:n,isError:o,error:i}=b({queryFn:()=>k(y),queryKey:["createOrder",t.get("reference")],staleTime:1/0,refetchOnWindowFocus:!1});return I.useEffect(()=>{n&&(p.success(c.message),r.from==="cart"&&localStorage.removeItem("cartItems"),a(w()),f("/account?tab=recent-orders",{replace:!0}),localStorage.removeItem("orderDetails")),o&&p.error(i)},[c,i,o,n]),e.jsx("div",{className:"bg-white py-10 h-80",children:e.jsx("section",{className:"wrapper flex items-center justify-center flex-col gap-4 h-full",children:j?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-500 text-lg",children:"Processing your payment..."}),e.jsx("p",{className:"text-lg",children:"Do not refresh the page or go back, you will be redirected to your account page once the payment/order is processed."})]}):o?e.jsx("p",{className:"text-red-500 text-lg",children:"Order creation failed. Please try again or contact support."}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"text-2xl font-600 text-black",children:"Payment Successful!"}),e.jsx(g,{to:"/",className:"text-white font-500 hover:underline bg-primary/2 px-3 py-2 rounded-md",children:"Continue Shopping"})]})})})};export{O as default};
