import{N as D,r as g,O as C,e as k,j as e,f as I,C as S,i as L,_ as b,R as A,S as O,s as F,A as M,m as R,L as P,P as q}from"./index-bzqS1RBf.js";import{a as T,h as B,b as G}from"./orders-l0rvhfFf.js";import{c as $,d as K}from"./getPriceAfterDiscount-VUBNXaOO.js";import{u as Q}from"./useQueries-Fshzjw89.js";import{n as V}from"./no-address-F9_hSvsD.js";import{g as Y,b as H,c as J,C as W}from"./CartPageSkeleton-mfYdLRhq.js";import{A as U}from"./AppEmpty-lm7pqbRT.js";var w=function(){return w=Object.assign||function(r){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},w.apply(this,arguments)},X=function(r,t){var n={};for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&t.indexOf(a)<0&&(n[a]=r[a]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,a=Object.getOwnPropertySymbols(r);s<a.length;s++)t.indexOf(a[s])<0&&Object.prototype.propertyIsEnumerable.call(r,a[s])&&(n[a[s]]=r[a[s]]);return n},Z=D("PulseLoader","0% {transform: scale(1); opacity: 1} 45% {transform: scale(0.1); opacity: 0.7} 80% {transform: scale(1); opacity: 1}","pulse");function ee(r){var t=r.loading,n=t===void 0?!0:t,a=r.color,s=a===void 0?"#000000":a,d=r.speedMultiplier,u=d===void 0?1:d,p=r.cssOverride,l=p===void 0?{}:p,x=r.size,o=x===void 0?15:x,c=r.margin,N=c===void 0?2:c,j=X(r,["loading","color","speedMultiplier","cssOverride","size","margin"]),f=w({display:"inherit"},l),y=function(v){return{backgroundColor:s,width:C(o),height:C(o),margin:C(N),borderRadius:"100%",display:"inline-block",animation:"".concat(Z," ").concat(.75/u,"s ").concat(v*.12/u,"s infinite cubic-bezier(0.2, 0.68, 0.18, 1.08)"),animationFillMode:"both"}};return n?g.createElement("span",w({style:f},j),g.createElement("span",{style:y(1)}),g.createElement("span",{style:y(2)}),g.createElement("span",{style:y(3)})):null}const se=({selectedAddress:r,setSelectedAddress:t,i:n,address:a})=>{var d,u,p,l,x;const{user:s}=k(o=>o.user);return e.jsx(e.Fragment,{children:s[a]&&e.jsxs("button",{onClick:()=>t(a),className:`flex items-start justify-start text-start flex-col gap-1 border-2  py-2 px-8 rounded-lg  transition-colors ${r===a?"border-primary":"hover:border-green-200 border-gray-100"}      
          `,children:[e.jsxs("span",{className:"text-lg font-500",children:["Address ",n+1]}),e.jsx("span",{children:(d=s[a])==null?void 0:d.landmark}),e.jsx("span",{children:(u=s[a])==null?void 0:u.address}),e.jsxs("span",{children:[(p=s[a])==null?void 0:p.state,", ",(l=s[a])==null?void 0:l.city]}),e.jsx("span",{children:(x=s[a])==null?void 0:x.pin_code})]})})},re=({totalAmount:r,totalItems:t,finalAmount:n,discountAmount:a,deliveryAddress:s,orderItems:d,isSomeItemOutOfStock:u})=>{const p=I(),[l,x]=g.useState({code:"",isCouponApplied:!1}),{state:o}=S(),{user:c}=k(i=>i.user),[N,j]=g.useState(!1),f="flex justify-between text-base sm:text-lg gap-6 min-w-max w-full",{mutate:y,isPending:v,data:h}=L({mutationFn:i=>T(i),onError:i=>{b.error(i)},onSuccess:i=>{x(m=>({...m,isCouponApplied:!0})),b.success("Coupon Applied Successfully, you saved ₹"+i.discount),A.event({category:"Coupon",action:`Applied coupon ${l}`})}}),_=async()=>{var i;if(N)return b.error("Processing your request");if(u)return O.fire({icon:"error",title:"Oops...",text:"Some items are out of stock! Please remove them and try again",confirmButtonText:"Go to Cart"}).then(m=>{m.isConfirmed&&p("/cart")});if(!(c.primaryaddress||c.secondaryaddress||c.thirdaddress))return O.fire({icon:"error",title:"Oops...",text:"Please add a delivery address",confirmButtonText:"Add Address"}).then(m=>{m.isConfirmed&&p("/account?tab=addresses")});j(!0);try{localStorage.removeItem("orderDetails"),F("orderDetails",{deliveryAddress:{...c[s],phoneNo:c.phoneNo,pinCode:(i=c[s])==null?void 0:i.pin_code},orderItems:d,from:o==null?void 0:o.from,coupon:{isCouponApplied:l.isCouponApplied,code:l.code,discount:(h==null?void 0:h.discount)||0}}),A.event({category:"Checkout",action:"Clicked on Proceed to Pay"});const m=await B(),E=await G(Math.max(1,n-(l.isCouponApplied?h.discount:0))),z={key:m,amount:E.order.amount,currency:"INR",name:"Java Sports",description:"",image:"java-sports.svg",order_id:E.order.id,callback_url:M.paymentVerification,prefill:{name:c.full_name,email:c.email,contact:c.phoneNo},notes:{address:"Razorpay Corporate Office"},theme:{color:"#121212"},modal:{ondismiss:function(){localStorage.removeItem("orderDetails"),j(!1),b.error("Payment Cancelled"),A.event({category:"Checkout",action:"Payment Cancelled"})}}};new window.Razorpay(z).open()}catch{b.error("Something went wrong")}finally{j(!1)}};return e.jsxs("div",{className:"shadow-md border border-gray-200 border-opacity-40 sticky xl:top-4 rounded-md px-4 py-5 sm:p-6 bg-white h-fit flex flex-col gap-3 text-gray-700 sm:min-w-96 min-h-80 justify-center",children:[e.jsx("span",{className:"uppercase text-xl font-600 text-black",children:"Price Details"}),e.jsx("hr",{}),e.jsxs("div",{className:f,children:[e.jsxs("span",{children:["Price (",t," items)"]}),e.jsxs("span",{children:["₹",r]})]}),e.jsxs("div",{className:f,children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{className:"text-green-400 text-[17px]",children:[" - ₹",a]})]}),l.isCouponApplied&&e.jsxs("div",{className:f,children:[e.jsx("span",{children:"Coupon"}),e.jsxs("span",{className:"text-green-400 text-[17px]",children:[" ","- ₹",h.discount]})]}),e.jsxs("div",{className:f,children:[e.jsx("span",{children:"Delivery Charges"}),e.jsx("span",{className:"text-green-400 text-[17px]",children:"Free"})]}),e.jsx("hr",{}),e.jsxs("div",{className:f+" font-700",children:[e.jsx("span",{children:"Total Amount"}),e.jsxs("span",{children:["₹",l.isCouponApplied?Math.max(1,n-h.discount):n]})]}),e.jsx("hr",{}),e.jsxs("span",{className:"text-sm text-grey-dark",children:["You will save ₹"," ",a+(l.isCouponApplied?h.discount:0)," on this order"]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("form",{onSubmit:i=>{var m;i.preventDefault(),l.code.trim()!==""&&y((m=l==null?void 0:l.code)==null?void 0:m.trim())},className:"flex flex-col xs:flex-row",children:[e.jsx("input",{className:"border rounded-t-md xs:rounded-l-md xs:rounded-tr-none py-2 flex-grow px-3 focus:outline-grey/2 text-gray-500 sm:text-lg",type:"text",placeholder:"Enter the Coupon code",value:l.code,onChange:i=>x({...l,code:i.target.value}),disabled:l.isCouponApplied||v}),e.jsx("button",{disabled:l.isCouponApplied||v||l.code.trim()==="",className:"bg-grey/1 font-500 px-6 py-1",children:l.isCouponApplied?"Applied":v?e.jsx(ee,{size:8,color:"#121212"}):"Apply"})]}),e.jsx("button",{onClick:_,className:"bg-red-500 text-lg py-2 text-white rounded-[5px] font-500",children:N?"Processing...":"Proceed to Pay"})]})]})},te=({item:r,response:t})=>{const{data:n,isLoading:a,isError:s}=t;return a||s?null:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 border p-3 rounded-md w-full",children:[e.jsx("div",{className:"h-full flex items-center justify-center bg-grey/1 rounded-lg p-2 object-contain object-center w-fit group",children:e.jsx("img",{src:n.product.images[0].url,alt:n.product.name,className:"w-52 object-contain object-center"})}),e.jsxs("div",{className:"flex flex-col gap-4 relative",children:[e.jsx("h1",{className:"text-xl font-[600]",children:n.product.name}),e.jsxs("div",{className:"flex flex-col gap-1 text-base sm:text-lg",children:[e.jsxs("span",{className:"text-primary text-xs sm:text-sm font-500",children:["Special Price"," "]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("span",{className:"text-neutral-black text-xl font-500",children:["₹",$(n.product.baseprice,n.product.discountedpercent)]}),e.jsxs("span",{className:"text-[#999999] line-through",children:["₹",n.product.baseprice]}),e.jsxs("span",{className:"text-[#00B553] font-500",children:[n.product.discountedpercent??0,"% off"]})]})]}),e.jsx("hr",{}),e.jsxs("div",{className:"flex gap-2 sm:gap-6",children:[e.jsxs("div",{className:"font-[600] text-lg flex flex-col gap-2",children:[e.jsx("span",{children:"Quantity"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:e.jsx("span",{className:"px-4 py-1 border-2 border-[#E4E4E4] rounded-md font-500 text-black",children:r.quantity})})]}),r.size&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"h-[80%] w-[1.5px] bg-grey-light opacity-50 self-end hidden md:block"}),e.jsxs("div",{className:"flex flex-col gap-1 sm:gap-2",children:[e.jsx("span",{className:"font-500 text-neutral-black text-lg",children:"Size"}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:e.jsx("span",{className:"px-4 py-1 border-2 border-[#E4E4E4] rounded-md font-500 text-black",children:r.size})})]})]}),r.color&&e.jsxs(e.Fragment,{children:[e.jsx("hr",{className:"h-[80%] w-[1.5px] bg-grey-light opacity-50 self-end hidden md:block"}),e.jsx("hr",{className:" bg-grey-light opacity-50 md:hidden"}),e.jsxs("div",{className:"font-[600] text-lg flex flex-col gap-2",children:[e.jsx("span",{children:"Color"}),e.jsx("div",{className:"flex gap-3",children:e.jsx("span",{className:"w-8 h-8 rounded-full border-[#E4E4E4] border-[2.5px]",style:{backgroundColor:r.color}})})]})]})]})]})]})},ae=()=>{var u,p,l,x;const r=I(),{user:t}=k(o=>o.user),[n,a]=g.useState("primaryaddress"),{state:s}=S(),d=Q({queries:(u=s==null?void 0:s.orderItems)==null?void 0:u.map(o=>({queryKey:["product",o.product],queryFn:()=>K(o.product)}))});return s||r("/cart"),e.jsx("div",{className:"bg-white py-10",children:e.jsxs("section",{className:"wrapper flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-5 justify-center card-shadow p-6 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xl sm:text-3xl  font-700 font-Lato",children:"Logged in as"}),e.jsx("span",{className:"text-blue font-500"})]}),e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsx("img",{src:((p=t==null?void 0:t.avatar)==null?void 0:p.url)||R,className:"w-12 h-12 rounded-full object-cover object-center"}),e.jsx(P,{to:"/account",className:"font-500 text-xl hover:underline",children:t==null?void 0:t.full_name})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("span",{children:["Email: ",t==null?void 0:t.email]}),e.jsxs("span",{children:["Phone: ",t==null?void 0:t.phoneNo]})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 justify-center card-shadow p-6 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xl sm:text-3xl font-700 font-Lato",children:"Delivery Address"}),e.jsx(P,{to:"/account?tab=addresses",className:"text-blue font-500",children:"Edit"})]}),e.jsx("div",{className:"flex gap-3 flex-col lg:flex-row",children:["primaryaddress","secondaryaddress","thirdaddress"].map((o,c)=>e.jsx(se,{selectedAddress:n,setSelectedAddress:a,address:o,i:c},c))}),!(t.primaryaddress||t.secondaryaddress||t.thirdaddress)&&e.jsx(U,{btnText:"Add Address",text:"You have not added any address",to:"/account?tab=addresses",img:V})]}),d.every(o=>o.isSuccess)?e.jsxs("div",{className:"flex gap-6 flex-col xl:flex-row",children:[e.jsxs("div",{className:"flex flex-col flex-grow gap-4 card-shadow p-6 rounded-md",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-xl sm:text-3xl font-700 font-Lato",children:"Order Summery"}),(s==null?void 0:s.from)&&(s==null?void 0:s.from)!=="reorder"&&e.jsx(P,{to:s!=null&&s.from&&(s==null?void 0:s.from)==="product"?`/product/${(l=s==null?void 0:s.orderItems[0])==null?void 0:l.id}`:"/cart",className:"text-blue font-500 text-lg",children:"Edit"})]}),e.jsxs("div",{className:"flex gap-5 flex-col",children:[s==null?void 0:s.orderItems.map((o,c)=>e.jsx(te,{item:o,response:d[c]},c)),(s==null?void 0:s.orderItems.length)===0&&e.jsx("span",{children:"No items in the cart"})]})]}),e.jsx(re,{totalAmount:Y(d.map(o=>o.data.product),s==null?void 0:s.orderItems),discountAmount:H(d.map(o=>o.data.product),s==null?void 0:s.orderItems),totalItems:(x=s==null?void 0:s.orderItems)==null?void 0:x.length,finalAmount:J(d.map(o=>o.data.product),s==null?void 0:s.orderItems),deliveryAddress:n,orderItems:s==null?void 0:s.orderItems,isSomeItemOutOfStock:d.some(o=>o.data.product.stock<1)})]}):e.jsx(W,{})]})})},me=()=>{const{state:r}=S();return r?e.jsx(ae,{}):e.jsx(q,{to:"/cart"})};export{me as default};
