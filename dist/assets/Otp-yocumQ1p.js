import{f as S,p as v,h as y,r as o,D as O,i as c,j as s,_ as r,E as P,z as E}from"./index-658m9aEm.js";import{u as T}from"./index.esm-7UVMojb0.js";const l=60*5,C=()=>{const u=S(),[m]=v(),x=m.get("redirect"),d=y(),[n,i]=o.useState(l),{register:p,handleSubmit:f}=T(),{state:t}=O(),{isPending:g,mutate:h}=c({mutationFn:e=>P(e),onError:e=>{r.error(e)},onSuccess:e=>{r.success(e.message),d.invalidateQueries({queryKey:["user"]}),u(x||"/account")}}),b=e=>{var a;h({email:((a=t==null?void 0:t.user)==null?void 0:a.email)||"",otp:e.otp})},{isPending:j,mutate:N}=c({mutationFn:e=>E(e),onError:e=>{r.error(e)},onSuccess:e=>{r.success(e.message),i(l)}});return o.useEffect(()=>{let e=setInterval(()=>{n!==1&&i(a=>a-1)},1e3);return()=>clearInterval(e)},[]),s.jsxs("form",{onSubmit:f(b),className:"flex flex-col gap-6 p-14 bg-grey/1 max-sm:mx-5 max-sm:p-8",children:[s.jsx("h1",{className:"text-4xl font-700",children:"Otp verification"}),s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx("label",{htmlFor:"otp",className:"text-sm font-700 font-Lato ",children:"Enter OTP"}),s.jsx("input",{className:"p-2 border-none rounded-xl",type:"text",placeholder:"Otp",...p("otp")})]}),s.jsx("button",{className:"p-3 text-white bg-black font-700 rounded-3xl font-Lato mx-14",children:g?"Verifying...":"Verify"}),n>1?s.jsxs("span",{className:"text-sm text-center ",children:["You can request the OTP in ",n," seconds"]}):s.jsxs("span",{className:"text-sm text-center ",children:["Didn't receive the OTP?"," ",s.jsx("button",{type:"button",onClick:()=>{if(!(t!=null&&t.user)){r.error("Please register first");return}N(t==null?void 0:t.user)},disabled:n>1,className:"text-red-500 underline",children:j?"Sending...":"Send Again"})]})]})};export{C as default};
